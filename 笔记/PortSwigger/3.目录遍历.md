# 目录遍历

目录遍历（也称为文件路径遍历）是一种 Web 安全漏洞，允许攻击者读取运行应用程序的服务器上的任意文件。这可能包括应用程序代码和数据、后端系统的凭据以及敏感的操作系统文件。在某些情况下，攻击者可能能够写入服务器上的任意文件，允许他们修改应用程序数据或行为，并最终完全控制服务器。

## 通过目录遍历读取任意文件

考虑一个显示待售商品图像的购物应用程序。图像通过一些 HTML 加载，如下所示：

>< img src="/loadImage?filename=218.png">

该应用程序没有针对目录遍历攻击实施任何防御措施，因此攻击者可以请求以下 URL 从服务器的文件系统中检索任意文件：
>h ttps://insecure-website.com/loadImage?filename=../../../etc/passwd

## 利用文件路径遍历漏洞的常见障碍

### 利用绝对路径绕过

>可以使用来自文件系统根目录的绝对路径，例如`filename=/etc/passwd`直接引用文件，而无需使用任何遍历序列。

### 利用非递归剥离绕过

> ....//....//....//etc/passwd
> ...//  ....\/

### 利用多余URL解码剥离绕过

>可以通过 URL 编码，甚至双重 URL 编码，绕过这种清理，这些`../`字符分别产生`%2e%2e%2f`或`%252e%252e%252f`。各种非标准编码，例如`..%c0%af`or `..%ef%bc%8f`，也可以解决问题。

### 利用相对路径绕过

>如果应用程序要求用户提供的文件名必须以预期的基本文件夹开头，例如/var/www/images，则可以包括所需的基本文件夹，然后是合适的遍历序列。例如：
   filename=/var/www/images/../../../etc/passwd

### 利用预期文件拓展名

>如果应用程序要求用户提供的文件名必须以预期的文件扩展名结尾，例如`.png`，则可以使用空字节在所需扩展名之前有效地终止文件路径。例如：
   filename=../../../etc/passwd%00.png