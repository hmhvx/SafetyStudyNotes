# 信息泄露漏洞

信息披露，也称为信息泄露，是指网站无意中向用户泄露敏感信息。根据具体情况，网站可能会将各种信息泄露给潜在的攻击者，包括：

-   有关其他用户的数据，例如用户名或财务信息
-   敏感的商业或商业数据
-   关于网站及其基础设施的技术细节

泄露敏感用户或业务数据的危险是相当明显的，但披露技术信息有时也同样严重。尽管其中一些信息的用途有限，但它可能成为暴露额外攻击面的起点，其中可能包含其他有趣的漏洞。在尝试构建复杂的高严重性攻击时，您能够收集的知识甚至可以提供缺失的部分。

## 有哪些信息披露的例子

信息披露的一些基本示例如下：

-   `robots.txt`通过文件或目录列表 显示隐藏目录的名称、结构和内容
-   通过临时备份提供对源代码文件的访问
-   在错误消息中明确提及数据库表或列名
-   不必要地暴露高度敏感的信息，例如信用卡详细信息
-   在源代码中硬编码 API 密钥、IP 地址、数据库凭证等
-   通过应用程序行为的细微差异来暗示资源、用户名等是否存在

## 信息泄露漏洞是如何产生的

信息披露漏洞可能以无数种不同的方式出现，但大致可分为以下几类：

-   **未能从公共内容中删除内部内容**。例如，标记中的开发人员评论有时对生产环境中的用户可见。
-   **网站和相关技术的不安全配置**。例如，未能禁用调试和诊断功能有时可以为攻击者提供有用的工具来帮助他们获取敏感信息。默认配置也可能使网站容易受到攻击，例如，通过显示过于冗长的错误消息。
-   **应用程序的设计和行为有缺陷**。例如，如果一个网站在发生不同的错误状态时返回不同的响应，这也可以让攻击者[枚举敏感数据](https://portswigger.net/web-security/authentication/password-based#username-enumeration)，例如有效的用户凭据。

## 信息泄露漏洞的影响是什么

信息披露漏洞可能会产生直接和间接的影响，具体取决于网站的目的，以及攻击者能够获得的信息。在某些情况下，仅披露敏感信息的行为就可能对受影响的各方产生重大影响。例如，一家网上商店泄露其客户的信用卡详细信息可能会产生严重后果。

另一方面，泄露的技术信息，例如目录结构或正在使用的第三方框架，可能几乎没有直接影响。然而，如果在坏人手中，这可能是构建任意数量的其他漏洞所需的关键信息。这种情况下的严重性取决于攻击者能够使用这些信息做什么。

## 信息披露的常见来源

### 网络爬虫的文件

许多网站提供文件`/robots.txt`并`/sitemap.xml`帮助爬虫浏览他们的网站。除其他外，这些文件通常会列出爬虫应跳过的特定目录，例如，因为它们可能包含敏感信息。

由于这些文件通常不会从网站内链接，它们可能不会立即出现在 Burp 的站点地图中。但是，值得尝试导航到`/robots.txt`或`/sitemap.xml`手动查看是否有任何用处。

### 目录列表

Web 服务器可以配置为自动列出不存在索引页面的目录的内容。这可以帮助攻击者快速识别给定路径上的资源，并直接分析和攻击这些资源。它特别增加了目录中不打算供用户访问的敏感文件的暴露，例如临时文件和故障转储。

目录列表本身不一定是安全漏洞。但是，如果网站也没有实施适当的访问控制，那么以这种方式泄露敏感资源的存在和位置显然是一个问题。

### 开发者评论

在开发过程中，有时会将内嵌 HTML 注释添加到标记中。在将更改部署到生产环境之前，通常会删除这些注释。但是，有时可能会忘记、遗漏评论，甚至故意留下评论，因为有人没有完全意识到安全隐患。尽管这些评论在呈现的页面上不可见，但可以使用 Burp 甚至浏览器的内置开发人员工具轻松访问它们。

有时，这些评论包含对攻击者有用的信息。例如，它们可能暗示隐藏目录的存在或提供有关应用程序逻辑的线索。

### 错误信息

信息泄露的最常见原因之一是冗长的错误消息。作为一般规则，您应该密切注意在审核期间遇到的所有错误消息。

错误消息的内容可以揭示有关给定参数预期的输入或数据类型的信息。这可以通过识别可利用的参数来帮助您缩小攻击范围。它甚至可以防止您浪费时间尝试注入根本不起作用的有效负载。

详细的错误消息还可以提供有关网站使用的不同技术的信息。例如，他们可能会明确命名网站正在使用的模板引擎、数据库类型或服务器，以及其版本号。此信息很有用，因为您可以轻松搜索此版本可能存在的任何已记录的漏洞利用。同样，您可以检查是否有任何常见的配置错误或您可以利用的危险默认设置。其中一些可能会在官方文档中突出显示。

您可能还会发现该网站正在使用某种开源框架。在这种情况下，您可以研究公开可用的源代码，这是构建您自己的漏洞利用的宝贵资源。

### 调试数据

出于调试目的，许多网站会生成自定义错误消息和日志，其中包含有关应用程序行为的大量信息。虽然这些信息在开发过程中很有用，但如果它在生产环境中泄露，它对攻击者也非常有用。

调试消息有时可能包含开发攻击的重要信息，包括：

-   可以通过用户输入操作的关键会话变量的值
-   后端组件的主机名和凭据
-   服务器上的文件和目录名称
-   用于加密通过客户端传输的数据的密钥

调试信息有时可能会记录在单独的文件中。如果攻击者能够访问此文件，它可以作为了解应用程序运行时状态的有用参考。它还可以提供一些线索，说明他们如何提供精心设计的输入来操纵应用程序状态和控制接收到的信息。

### 用户帐户页面

就其本质而言，用户的个人资料或帐户页面通常包含敏感信息，例如用户的电子邮件地址、电话号码、API 密钥等。由于用户通常只能访问自己的帐户页面，因此这本身并不代表漏洞。但是，某些网站包含可能允许攻击者利用这些页面来查看其他用户数据的 [逻辑缺陷。](https://portswigger.net/web-security/logic-flaws)

例如，考虑一个根据`user`参数确定要加载哪个用户的帐户页面的网站。

`GET /user/personal-info?user=carlos`

大多数网站将采取措施防止攻击者简单地更改此参数以访问任意用户的帐户页面。但是，有时加载单个数据项的逻辑并不那么健壮。

攻击者可能无法完全加载其他用户的帐户页面，但获取和呈现用户注册电子邮件地址的逻辑可能无法检查`user`参数是否与当前登录的用户匹配。在这种情况下，简单地更改`user`参数将允许攻击者在他们自己的帐户页面上显示任意用户的电子邮件地址。

### 通过备份文件泄露源代码

获得源代码访问权限使攻击者更容易了解应用程序的行为并构建高严重性攻击。敏感数据有时甚至被硬编码在源代码中。这方面的典型示例包括用于访问后端组件的 API 密钥和凭据。

如果您可以确定正在使用某种特定的开源技术，则可以轻松访问有限数量的源代码。

有时甚至可能导致网站暴露自己的源代码。在规划网站时，您可能会发现某些源代码文件被明确引用。不幸的是，请求它们通常不会显示代码本身。当服务器处理具有特定扩展名的文件时，例如`.php`，它通常会执行代码，而不是简单地将其作为文本发送给客户端。但是，在某些情况下，您可以诱使网站返回文件的内容。例如，文本编辑器通常会在编辑原始文件时生成临时备份文件。这些临时文件通常以某种方式表示，例如通过附加波浪号 (`~`) 到文件名或添加不同的文件扩展名。使用备份文件扩展名请求代码文件有时可以让您在响应中读取文件的内容。

### 配置不安全导致信息泄露

由于配置不当，网站有时很容易受到攻击。由于第三方技术的广泛使用，这种情况尤其常见，其大量的配置选项不一定被实施它们的人充分理解。

在其他情况下，开发人员可能会忘记在生产环境中禁用各种调试选项。例如，HTTP`TRACE`方法是为诊断目的而设计的。如果启用，Web 服务器将`TRACE`通过在响应中回显接收到的确切请求来响应使用该方法的请求。这种行为通常是无害的，但偶尔会导致信息泄露，例如反向代理可能附加到请求的内部身份验证标头的名称。

### 版本控制历史

几乎所有网站都是使用某种形式的版本控制系统开发的，例如 Git。默认情况下，Git 项目将其所有版本控制数据存储在一个名为`.git`. 有时，网站会在生产环境中公开此目录。在这种情况下，您可以通过简单地浏览来访问它`/.git`。

虽然手动浏览原始文件结构和内容通常是不切实际的，但有多种方法可以下载整个`.git`目录。然后，您可以使用本地安装的 Git 打开它，以访问网站的版本控制历史记录。这可能包括包含已提交更改和其他有趣信息的日志。

这可能无法让您访问完整的源代码，但比较差异将使您能够阅读小段代码。与任何源代码一样，您可能还会在某些更改的行中找到硬编码的敏感数据。


## 如何评估信息泄露漏洞的严重性

尽管最终影响可能非常严重，但仅在特定情况下，信息披露本身就是一个严重程度较高的问题。在测试期间，特别是技术信息的披露通常只有在您能够证明攻击者如何利用它做一些有害的事情时才有意义。

例如，如果该版本已完全修补，则知道网站正在使用特定框架版本的知识是有限的。但是，当网站使用包含已知漏洞的旧版本时，此信息会变得很重要。在这种情况下，执行破坏性攻击可能就像应用公开记录的漏洞一样简单。

当您发现潜在的敏感信息被泄露时，运用常识很重要。在您测试的许多网站上，很可能可以通过多种方式发现次要的技术细节。因此，您的主要关注点应该是泄露信息的影响和可利用性，而不仅仅是信息披露作为一个独立问题的存在。一个明显的例外是当泄露的信息非常敏感以至于它本身就值得关注时。

## 如何防范信息泄露漏洞

由于信息泄露的发生方式多种多样，因此完全防止信息泄露非常棘手。但是，您可以遵循一些通用的最佳实践，以最大程度地降低此类漏洞潜入您自己网站的风险。

-   确保参与制作网站的每个人都充分了解哪些信息被视为敏感信息。有时，看似无害的信息对攻击者来说可能比人们意识到的要有用得多。突出这些危险有助于确保您的组织总体上更安全地处理敏感信息。
-   作为 QA 或构建过程的一部分，审核任何代码以防潜在的信息泄露。自动化一些相关任务应该相对容易，例如剥离开发人员评论。
-   尽可能使用通用错误消息。不要不必要地向攻击者提供有关应用程序行为的线索。
-   仔细检查生产环境中是否禁用了任何调试或诊断功能。
-   确保您完全了解您实施的任何第三方技术的配置设置和安全隐患。花时间调查并禁用您实际上不需要的任何功能和设置。